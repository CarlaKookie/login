"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3429],{9075:(te,j,f)=>{f.d(j,{J:()=>L});const L={FRONT:"front",BACK:"back"}},7464:(te,j,f)=>{f.d(j,{E_:()=>G,F3:()=>H});var g=f(467);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var R=function(n){return n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE",n}(R||{});class $ extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const Q=n=>{var e,t,i,s,r;const d=n.CapacitorCustomPlatform||null,a=n.Capacitor||{},y=a.Plugins=a.Plugins||{},u=n.CapacitorPlatforms,F=(null===(e=null==u?void 0:u.currentPlatform)||void 0===e?void 0:e.getPlatform)||(()=>null!==d?d.name:(n=>{var e,t;return null!=n&&n.androidBridge?"android":null!==(t=null===(e=null==n?void 0:n.webkit)||void 0===e?void 0:e.messageHandlers)&&void 0!==t&&t.bridge?"ios":"web"})(n)),de=(null===(t=null==u?void 0:u.currentPlatform)||void 0===t?void 0:t.isNativePlatform)||(()=>"web"!==F()),fe=(null===(i=null==u?void 0:u.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(h=>{const p=Z.get(h);return!!(null!=p&&p.platforms.has(F())||se(h))}),se=(null===(s=null==u?void 0:u.currentPlatform)||void 0===s?void 0:s.getPluginHeader)||(h=>{var p;return null===(p=a.PluginHeaders)||void 0===p?void 0:p.find(W=>W.name===h)}),Z=new Map,ve=(null===(r=null==u?void 0:u.currentPlatform)||void 0===r?void 0:r.registerPlugin)||((h,p={})=>{const W=Z.get(h);if(W)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),W.proxy;const S=F(),B=se(h);let _;const Pe=function(){var P=(0,g.A)(function*(){return!_&&S in p?_=_="function"==typeof p[S]?yield p[S]():p[S]:null!==d&&!_&&"web"in p&&(_=_="function"==typeof p.web?yield p.web():p.web),_});return function(){return P.apply(this,arguments)}}(),q=P=>{let C;const O=(...D)=>{const I=Pe().then(E=>{const M=((P,C)=>{var O,D;if(!B){if(P)return null===(D=P[C])||void 0===D?void 0:D.bind(P);throw new $(`"${h}" plugin is not implemented on ${S}`,R.Unimplemented)}{const I=null==B?void 0:B.methods.find(E=>C===E.name);if(I)return"promise"===I.rtype?E=>a.nativePromise(h,C.toString(),E):(E,M)=>a.nativeCallback(h,C.toString(),E,M);if(P)return null===(O=P[C])||void 0===O?void 0:O.bind(P)}})(E,P);if(M){const V=M(...D);return C=null==V?void 0:V.remove,V}throw new $(`"${h}.${P}()" is not implemented on ${S}`,R.Unimplemented)});return"addListener"===P&&(I.remove=(0,g.A)(function*(){return C()})),I};return O.toString=()=>`${P.toString()}() { [capacitor code] }`,Object.defineProperty(O,"name",{value:P,writable:!1,configurable:!1}),O},ae=q("addListener"),ce=q("removeListener"),ye=(P,C)=>{const O=ae({eventName:P},C),D=function(){var E=(0,g.A)(function*(){const M=yield O;ce({eventName:P,callbackId:M},C)});return function(){return E.apply(this,arguments)}}(),I=new Promise(E=>O.then(()=>E({remove:D})));return I.remove=(0,g.A)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield D()}),I},ee=new Proxy({},{get(P,C){switch(C){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return B?ye:ae;case"removeListener":return ce;default:return q(C)}}});return y[h]=ee,Z.set(h,{name:h,proxy:ee,platforms:new Set([...Object.keys(p),...B?[S]:[]])}),ee});return a.convertFileSrc||(a.convertFileSrc=h=>h),a.getPlatform=F,a.handleError=h=>n.console.error(h),a.isNativePlatform=de,a.isPluginAvailable=fe,a.pluginMethodNoop=(h,p,W)=>Promise.reject(`${W} does not have an implementation of "${p}".`),a.registerPlugin=ve,a.Exception=$,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},k=(n=>n.Capacitor=Q(n))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),H=k.registerPlugin;class G{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){var i=this;let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const d=this.windowListeners[e];d&&!d.registered&&this.addWindowListener(d),s&&this.sendRetainedArgumentsForEvent(e);const a=function(){var u=(0,g.A)(function*(){return i.removeListener(e,t)});return function(){return u.apply(this,arguments)}}();return Promise.resolve({remove:a})}removeAllListeners(){var e=this;return(0,g.A)(function*(){e.listeners={};for(const t in e.windowListeners)e.removeWindowListener(e.windowListeners[t]);e.windowListeners={}})()}notifyListeners(e,t,i){const s=this.listeners[e];if(s)s.forEach(r=>r(t));else if(i){let r=this.retainedEventArguments[e];r||(r=[]),r.push(t),this.retainedEventArguments[e]=r}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new k.Exception(e,R.Unimplemented)}unavailable(e="not available"){return new k.Exception(e,R.Unavailable)}removeListener(e,t){var i=this;return(0,g.A)(function*(){const s=i.listeners[e];if(!s)return;const r=s.indexOf(t);i.listeners[e].splice(r,1),i.listeners[e].length||i.removeWindowListener(i.windowListeners[e])})()}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const c=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),w=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class A extends G{getCookies(){return(0,g.A)(function*(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[s,r]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=w(s).trim(),r=w(r).trim(),t[s]=r}),t})()}setCookie(e){return(0,g.A)(function*(){try{const t=c(e.key),i=c(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),d=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${s}; path=${r}; ${d};`}catch(t){return Promise.reject(t)}})()}deleteCookie(e){return(0,g.A)(function*(){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}})()}clearCookies(){return(0,g.A)(function*(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}})()}clearAllCookies(){var e=this;return(0,g.A)(function*(){try{yield e.clearCookies()}catch(t){return Promise.reject(t)}})()}}H("CapacitorCookies",{web:()=>new A});const m=function(){var n=(0,g.A)(function*(e){return new Promise((t,i)=>{const s=new FileReader;s.onload=()=>{const r=s.result;t(r.indexOf(",")>=0?r.split(",")[1]:r)},s.onerror=r=>i(r),s.readAsDataURL(e)})});return function(t){return n.apply(this,arguments)}}();class N extends G{request(e){return(0,g.A)(function*(){const t=((n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=((n={})=>{const e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,r,d)=>(s[r]=n[e[d]],s),{})})(n.headers)["content-type"]||"";if("string"==typeof n.data)t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[d,a]of Object.entries(n.data||{}))r.set(d,a);t.body=r.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){const r=new FormData;if(n.data instanceof FormData)n.data.forEach((a,y)=>{r.append(y,a)});else for(const a of Object.keys(n.data))r.append(a,n.data[a]);t.body=r;const d=new Headers(t.headers);d.delete("content-type"),t.headers=d}else(s.includes("application/json")||"object"==typeof n.data)&&(t.body=JSON.stringify(n.data));return t})(e,e.webFetchExtra),i=((n,e=!0)=>n?Object.entries(n).reduce((i,s)=>{const[r,d]=s;let a,y;return Array.isArray(d)?(y="",d.forEach(u=>{a=e?encodeURIComponent(u):u,y+=`${r}=${a}&`}),y.slice(0,-1)):(a=e?encodeURIComponent(d):d,y=`${r}=${a}`),`${i}&${y}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),s=i?`${e.url}?${i}`:e.url,r=yield fetch(s,t),d=r.headers.get("content-type")||"";let y,u,{responseType:a="text"}=r.ok?e:{};switch(d.includes("application/json")&&(a="json"),a){case"arraybuffer":case"blob":u=yield r.blob(),y=yield m(u);break;case"json":y=yield r.json();break;default:y=yield r.text()}const X={};return r.headers.forEach((F,Y)=>{X[Y]=F}),{data:y,headers:X,status:r.status,url:r.url}})()}get(e){var t=this;return(0,g.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"GET"}))})()}post(e){var t=this;return(0,g.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"POST"}))})()}put(e){var t=this;return(0,g.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PUT"}))})()}patch(e){var t=this;return(0,g.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"PATCH"}))})()}delete(e){var t=this;return(0,g.A)(function*(){return t.request(Object.assign(Object.assign({},e),{method:"DELETE"}))})()}}H("CapacitorHttp",{web:()=>new N})},3429:(te,j,f)=>{f.r(j),f.d(j,{InicioPageModule:()=>ie});var g=f(177),K=f(4341),L=f(791),T=f(8986),ne=f(6261),U=f(467),z=f(7464);f(9075);const $=(0,z.F3)("BarcodeScanner",{web:()=>f.e(4651).then(f.bind(f,4651)).then(c=>new c.BarcodeScannerWeb)});var l=f(3953),Q=f(671),re=f(369),k=f(1626);let H=(()=>{var c;class w{constructor(o){this.http=o,this.apiUrl="http://localhost:3000/api/mark-attendance"}sendUserData(o){return o.date&&(o.date=new Date(o.date).toISOString().split("T")[0]),this.http.post(this.apiUrl,o)}}return(c=w).\u0275fac=function(o){return new(o||c)(l.KVO(k.Qq))},c.\u0275prov=l.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),w})();const oe=[{path:"",component:(()=>{var c;class w{constructor(o,m,v,b,x){this.router=o,this.authService=m,this.storage=v,this.userDataService=b,this.alertController=x,this.nombreUsuario=""}ngOnInit(){var o=this;return(0,U.A)(function*(){yield o.storage.create();const m=yield o.storage.get("nombre");o.nombreUsuario=m||"Usuario",console.log("Nombre recuperado desde el storage:",o.nombreUsuario)})()}logout(){var o=this;return(0,U.A)(function*(){o.canDeactivate({fromLogout:!0})&&(o.authService.logout(),yield o.storage.remove("nombre"),yield o.storage.remove("correo"),o.router.navigate(["/home"]))})()}canDeactivate(o){var m;const v=this.router.getCurrentNavigation();return!(!(null==v||null===(m=v.extras.state)||void 0===m?void 0:m.fromEdit)&&(null==o?void 0:o.fromLogout))||confirm("\xbfEst\xe1s seguro que deseas cerrar sesi\xf3n?")}startScan(){var o=this;return(0,U.A)(function*(){try{if((yield $.checkPermission({force:!0})).granted){var m;null===(m=document.querySelector("body"))||void 0===m||m.classList.add("scanner-active");const b=yield $.startScan();if(b.hasContent){console.log("Scanned content:",b.content);const x=JSON.parse(b.content),{sessionId:N,subject:J,section:n}=x;if(!N||!J||!n)return void o.presentAlert("Error","Datos incompletos","El QR escaneado no contiene todos los datos necesarios.");const e=o.authService.getUserEmail();if(!e)return void o.presentAlert("Error","Correo no encontrado","No se ha encontrado el correo electr\xf3nico del usuario.");const t={user:e,date:(new Date).toISOString(),section:n,status:"presente",subject:J,sessionId:N};o.sendData(t)}}else console.error("Permission denied")}catch(v){console.error("Error al escanear el c\xf3digo QR:",v),o.presentAlert("Error","Error en el escaneo","Hubo un problema al escanear el c\xf3digo QR.")}})()}sendData(o){var m=this;this.userDataService.sendUserData(o).subscribe(function(){var v=(0,U.A)(function*(b){console.log("Datos enviados correctamente",b),yield m.presentAlert("Asistencia","","confirmada")});return function(b){return v.apply(this,arguments)}}(),function(){var v=(0,U.A)(function*(b){console.error("Error al enviar los datos",b)});return function(b){return v.apply(this,arguments)}}())}presentAlert(o,m,v){var b=this;return(0,U.A)(function*(){yield(yield b.alertController.create({header:o,subHeader:m,message:v,buttons:["OK"]})).present()})()}}return(c=w).\u0275fac=function(o){return new(o||c)(l.rXU(T.Ix),l.rXU(Q.u),l.rXU(re.w),l.rXU(H),l.rXU(L.hG))},c.\u0275cmp=l.VBU({type:c,selectors:[["app-inicio"]],decls:11,vars:1,consts:[[1,"background-container"],["src","assets/Images/logo.png","alt","Logo",1,"logo"],[1,"welcome-message"],[1,"notas-section"],["color","primary","expand","block",1,"custom-button",3,"click"],["color","danger","expand","block",1,"custom-button",3,"click"]],template:function(o,m){1&o&&(l.j41(0,"ion-content")(1,"div",0),l.nrm(2,"img",1),l.j41(3,"div",2)(4,"p"),l.EFF(5),l.k0s()(),l.j41(6,"div",3)(7,"ion-button",4),l.bIt("click",function(){return m.startScan()}),l.EFF(8,"Marcar Asistencia"),l.k0s(),l.j41(9,"ion-button",5),l.bIt("click",function(){return m.logout()}),l.EFF(10,"Cerrar sesi\xf3n"),l.k0s()()()()),2&o&&(l.R7$(5),l.SpI("Bienvenido/a ",m.nombreUsuario,"!"))},dependencies:[L.Jm,L.W9],styles:[".background-container[_ngcontent-%COMP%]{width:100%;height:100vh;background-image:linear-gradient(to right,#002f6c,#0058a3);background-size:cover;background-position:center center;display:flex;flex-direction:column;justify-content:space-between;align-items:center;padding:30px;position:relative}.logo[_ngcontent-%COMP%]{width:300px;height:auto;margin-bottom:30px;animation:_ngcontent-%COMP%_bounce 2s infinite}.welcome-message[_ngcontent-%COMP%]{color:#fff;text-align:center;padding:20px;background:#000000b3;border-radius:15px;box-shadow:0 4px 10px #0000004d;font-family:Arial,sans-serif;font-size:1.5rem;font-weight:700;max-width:90%;max-height:250px;overflow:hidden;margin-bottom:20px}.button-section[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:20px;margin-bottom:20px}.custom-button[_ngcontent-%COMP%]{width:200px;margin-bottom:15px;color:#fff!important;font-size:1.2rem;font-weight:700;border-radius:20px;padding:12px;box-shadow:0 4px 6px #0000004d;transition:all .3s ease}.custom-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(0)}50%{transform:translateY(-10px)}}body.scanner-active[_ngcontent-%COMP%]{background:transparent!important}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{background:transparent!important;overflow:hidden}ion-content[_ngcontent-%COMP%]{--background: transparent !important}"]}),w})(),canDeactivate:[ne.M]}];let G=(()=>{var c;class w{}return(c=w).\u0275fac=function(o){return new(o||c)},c.\u0275mod=l.$C({type:c}),c.\u0275inj=l.G2t({imports:[T.iI.forChild(oe),T.iI]}),w})(),ie=(()=>{var c;class w{}return(c=w).\u0275fac=function(o){return new(o||c)},c.\u0275mod=l.$C({type:c}),c.\u0275inj=l.G2t({imports:[g.MD,K.YN,L.bv,G]}),w})()}}]);